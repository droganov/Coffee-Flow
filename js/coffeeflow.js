// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i;r=function(e){if(i.debug)return typeof console!="undefined"&&console!==null?console.log(e):void 0};n=jQuery;i={blur:function(e){return r("CoffeeFlow blured")},change:function(e){return r("CoffeeFlow change")},ready:function(e){return r("CoffeeFlow ready")},select:function(e){return r("CoffeeFlow select")},focus:function(e){return r("CoffeeFlow focused")},borderWidth:1,debug:!1,density:3.2,defaultItem:2,minHeight:200,selectOnChange:!1,enableReflections:!1};e=function(){function e(e,r){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x=this;u=n(e);i=n.extend(i,n.data(e));i=n.extend(i,r);m=this;b="";a=i.defaultItem;y=[];o=n('<div class="coffeeflowCanvas"></div>');p=u.find("a");this.getCanvas=function(){return o};this.getData=function(){return o.data()};this.getHeight=function(){return o.height()};this.getIndex=function(){return a};this.getItem=function(e){e==null&&(e=a);return y[e]};this.getWidth=function(){return o.width()};this.hasFocus=function(){return u.is(".coffeeflowFocuse")};this.resize=function(){var e;u.height()>i.minHeight?e=u.height():e=i.minHeight;o.height(e);return s()};this.slideTo=function(e){e>=y.length&&(e=y.length-1);e<0&&(e=0);a=e;s();i.change(m);if(i.selectOnChange)return y[e].select()};s=function(){var e,t,n,r,s,u,f;f=[];for(s=0,u=y.length;s<u;s++){t=y[s];t.resize();n=o.height()/i.density;if(s===a){b="current";e=y.length+1;r=o.width()/2}else if(s<a){b="before";e=s;r=o.width()/2-n/2-(a-s)*n}else{b="after";e=y.length-s;r=o.width()/2+n/2+(s-a)*n}t.setDepth(e);t.setState(b);f.push(t.moveTo(r))}return f};f=function(){return b};d=function(e){var t,n;if(x.hasFocus()){e=e||event;t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));n=a+t;x.slideTo(n);return e.preventDefault?e.preventDefault():e.returnValue=!1}};v=function(){o.addClass("ready");x.resize();return i.ready(m)};g=function(e){return e=e};for(E=0,S=p.length;E<S;E++){c=p[E];h=new t(c,E,m);y.push(h);h.appendTo(o)}i.enableReflections&&u.addClass("coffeeflowReflections");u.append(o);this.resize();n(window).resize(function(e){return x.resize()});u.mouseover(function(e){if(!u.is(".coffeeflowFocuse")){u.addClass("coffeeflowFocuse");x.resize();i.focus(m)}return e.stopPropagation()});n("html").mouseover(function(e){if(u.is(".coffeeflowFocuse")){u.removeClass("coffeeflowFocuse");x.resize();i.blur(m);return e.stopPropagation()}});if(window.addEventListener){window.addEventListener("mousewheel",d,!1);window.addEventListener("DOMMouseScroll",d,!1)}else window.attachEvent("onmousewheel",d);if(typeof Hammer!="undefined"&&Hammer!==null){l=new Hammer(o[0],{prevent_default:!0,swipe_time:5e3,drag_min_distance:50,drag_vertical:!1,transform:!1,hold:!1});w=0;l.ondragstart=function(e){return w=(new Date).getTime()};l.onswipe=function(e){var t,n,r;n=e.originalEvent.timeStamp-w;t=Math.ceil(e.distance/n);r=a;switch(e.direction){case"left":r+=t;break;case"right":r-=t}return x.slideTo(r)}}setTimeout(v,10)}typeof window!="undefined"&&window!==null&&(window.Coffeeflow=e);return e}();t=function(){function e(e,t,s){var o,u,a,f,l,c,h=this;c="";s=s;l=n(e).addClass("coffeeflowItem");a=l.find("img");l.css({top:i.borderWidth+"px"});a.css({"border-width":i.borderWidth+"px",margin:-i.borderWidth+"px"});a.load(function(e){return o()});if(typeof Hammer!="undefined"&&Hammer!==null){u=new Hammer(a[0],{prevent_default:!1,drag:!1,swipe:!1,transform:!1,tap_double:!1,hold:!1});u.ontap=function(e){l.is(".current")?f():s.slideTo(t);return r("tap")}}else a.click(function(e){return l.is(".current")?f():s.slideTo(t)});l.click(function(e){return e.preventDefault()});this.appendTo=function(e){return l.appendTo(e)};this.setDepth=function(e){return l.css("z-index",e)};this.setState=function(e){l.removeClass("before");l.removeClass("current");l.removeClass("after");e!=="current"&&l.removeClass("selected");l.addClass(e);c=e;return o()};this.moveTo=function(e){var t;e-=l.width()/2;t=!0;switch(c){case"before":t=e>0-l.width();break;case"after":t=e<0+s.getWidth()}t?l.css({visibility:"visible"}):l.css({visibility:"hidden"});return l.css({left:e+"px"})};this.resize=function(){var e;e=s.getCanvas().height()-i.borderWidth*2;return l.height(e).width(e)};o=function(){switch(c){case"current":return a.css({left:(l.height()-a.width())/2+"px"});case"before":return a.css({left:0});case"after":return a.css({right:0})}};f=function(){l.addClass("selected");return i.select(s)}}return e}()}).call(this);