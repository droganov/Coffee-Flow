// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i;r=function(e){if(i.debug)return typeof console!="undefined"&&console!==null?console.log(e):void 0};n=jQuery;i={blur:function(e){return r("CoffeeFlow blured")},change:function(e){return r("CoffeeFlow change")},ready:function(e){return r("CoffeeFlow ready")},select:function(e){return r("CoffeeFlow select")},focus:function(e){return r("CoffeeFlow focused")},borderWidth:1,debug:!1,density:3.2,defaultItem:2,minHeight:200,selectOnChange:!1};e=function(){function e(e,s){var o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T=this;a=n(e);i=n.extend(i,n.data(e));i=n.extend(i,s);g=this;w="";f=i.defaultItem;b=[];u=n('<div class="coffeeflowCanvas"></div>');d=a.find("a");this.getCanvas=function(){return u};this.getData=function(){return u.data()};this.getHeight=function(){return u.height()};this.getIndex=function(){return f};this.getItem=function(e){e==null&&(e=f);return b[e]};this.getWidth=function(){return u.width()};this.hasFocus=function(){return a.is(".coffeeflowFocuse")};this.resize=function(){var e;a.height()>i.minHeight?e=a.height():e=i.minHeight;u.height(e);return o()};this.slideTo=function(e){e>=b.length&&(e=b.length-1);e<0&&(e=0);f=e;o();i.change(g);if(i.selectOnChange)return b[e].select()};o=function(){var e,t,n,r,s,o,a;a=[];for(s=0,o=b.length;s<o;s++){t=b[s];t.resize();n=u.height()/i.density;if(s===f){w="current";e=b.length+1;r=u.width()/2}else if(s<f){w="before";e=s;r=u.width()/2-n/2-(f-s)*n}else{w="after";e=b.length-s;r=u.width()/2+n/2+(s-f)*n}t.setDepth(e);t.setState(w);a.push(t.moveTo(r))}return a};l=function(){return w};v=function(e){var t,n;if(T.hasFocus()){e=e||event;t=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail));n=f+t;T.slideTo(n);return e.preventDefault?e.preventDefault():e.returnValue=!1}};m=function(){u.addClass("ready");T.resize();return i.ready(g)};y=function(e){return e=e};for(S=0,x=d.length;S<x;S++){h=d[S];p=new t(h,S,g);b.push(p);p.appendTo(u)}a.append(u);this.resize();n(window).resize(function(e){return T.resize()});a.mouseover(function(e){if(!a.is(".coffeeflowFocuse")){a.addClass("coffeeflowFocuse");T.resize();i.focus(g)}return e.stopPropagation()});n("html").mouseover(function(e){if(a.is(".coffeeflowFocuse")){a.removeClass("coffeeflowFocuse");T.resize();i.blur(g);return e.stopPropagation()}});if(window.addEventListener){window.addEventListener("mousewheel",v,!1);window.addEventListener("DOMMouseScroll",v,!1)}else window.attachEvent("onmousewheel",v);if(typeof Hammer!="undefined"&&Hammer!==null){c=new Hammer(u[0],{prevent_default:!0,swipe_time:5e3,drag_min_distance:50,drag_vertical:!1,transform:!1,hold:!1});E=0;c.ondragstart=function(e){return E=(new Date).getTime()};c.onswipe=function(e){var t,n,r;n=e.originalEvent.timeStamp-E;t=Math.ceil(e.distance/n);r=f;switch(e.direction){case"left":r+=t;break;case"right":r-=t}return T.slideTo(r)};c.ontap=function(e){return r("tap")}}setTimeout(m,10)}typeof window!="undefined"&&window!==null&&(window.Coffeeflow=e);return e}();t=function(){function e(e,t,r){var s,o,u,a,f,l=this;f="";r=r;a=n(e).addClass("coffeeflowItem");o=a.find("img");a.css({top:i.borderWidth+"px"});o.css({"border-width":i.borderWidth+"px",margin:-i.borderWidth+"px"});o.load(function(e){return s()});a.click(function(e){e.preventDefault();return a.is(".current")?u():r.slideTo(t)});this.appendTo=function(e){return a.appendTo(e)};this.setDepth=function(e){return a.css("z-index",e)};this.setState=function(e){a.removeClass("before");a.removeClass("current");a.removeClass("after");e!=="current"&&a.removeClass("selected");a.addClass(e);f=e;return s()};this.moveTo=function(e){var t;e-=a.width()/2;t=!0;switch(f){case"before":t=e>0-a.width();break;case"after":t=e<0+r.getWidth()}t?a.show():a.hide();return a.css({left:e+"px"})};this.resize=function(){var e;e=r.getCanvas().height()-i.borderWidth*2;return a.height(e).width(e)};s=function(){switch(f){case"current":return o.css({left:(a.height()-o.width())/2+"px"});case"before":return o.css({left:0});case"after":return o.css({right:0})}};u=function(){a.addClass("selected");return i.select(r)}}return e}()}).call(this);