// Generated by CoffeeScript 1.3.3
(function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};jQuery.fn.extend({coverflow:function(t){var n,r,i,s,o;i=jQuery;o={blur:function(){return s("coverflow blured")},change:function(){return s("coverflow change")},ready:function(){return s("coverflow ready")},select:function(){return s("coverflow select")},focus:function(){return s("coverflow focused")},borderWidth:2,debug:!1,density:4.2,firstItem:2,minHeight:200,selectOnChange:!1};o=i.extend(o,t);s=function(e){if(o.debug)return typeof console!="undefined"&&console!==null?console.log(e):void 0};n=function(){function t(t){this.resize=e(this.resize,this);this.ready=e(this.ready,this);var n,s,u,a,f,l=this;this.state="";this.container=i(t);this.currentItem=o.firstItem;this.stack=[];this.canvas=i('<div class="coverFlowCanvas"></div>');u=this.container.find("a");for(a=0,f=u.length;a<f;a++){n=u[a];s=new r(n,a,this);this.stack.push(s);s.appendTo(this.canvas)}this.container.append(this.canvas);this.resize();i(window).resize(function(e){return l.resize()});this.container.click(function(e){if(!l.container.is(".coverflowFocuse")){l.container.addClass("coverflowFocuse");l.resize();o.focus(l)}return e.stopPropagation()});i("html").click(function(e){if(l.container.is(".coverflowFocuse")){l.container.removeClass("coverflowFocuse");l.resize();return o.blur(l)}});setTimeout(this.ready,10)}t.prototype.arrange=function(){var e,t,n,r,i,s,u,a,f;a=this.stack;f=[];for(s=0,u=a.length;s<u;s++){t=a[s];t.resize();n=this.canvas.height()/o.density;if(s===this.currentItem){r="current";e=this.stack.length+1;i=this.canvas.width()/2}else if(s<this.currentItem){r="before";e=s;i=this.canvas.width()/2-n/2-(this.currentItem-s)*n}else{r="after";e=this.stack.length-s;i=this.canvas.width()/2+n/2+(s-this.currentItem)*n}t.setDepth(e);t.moveTo(i);f.push(t.setState(r))}return f};t.prototype.getCanvas=function(){return this.canvas};t.prototype.getState=function(){return this.state};t.prototype.ready=function(){this.canvas.addClass("ready");this.resize();return o.ready(this)};t.prototype.resize=function(){var e;this.container.height()>o.minHeight?e=this.container.height():e=o.minHeight;this.canvas.height(e);return this.arrange()};t.prototype.setState=function(e){return this.state=e};t.prototype.slideTo=function(e){this.currentItem=e;this.arrange();o.change(this);if(o.selectOnChange)return this.stack[e].select()};return t}();r=function(){function e(e,t,n){var r=this;this.state="";this.p=n;this.self=i(e).addClass("coverflowItem");this.img=this.self.find("img");this.self.css({top:o.borderWidth+"px"});this.img.css({"border-width":o.borderWidth+"px",margin:-o.borderWidth+"px"});this.img.load(function(e){return r.align()});this.self.click(function(e){e.preventDefault();return r.self.is(".current")?r.select():n.slideTo(t)})}e.prototype.align=function(){switch(this.state){case"current":return this.img.css({left:(this.self.height()-this.img.width())/2+"px"});case"before":return this.img.css({left:0});case"after":return this.img.css({right:0})}};e.prototype.appendTo=function(e){return this.self.appendTo(e)};e.prototype.setDepth=function(e){return this.self.css("z-index",e)};e.prototype.select=function(){this.self.addClass("selected");return o.select(this.p)};e.prototype.setState=function(e){this.self.removeClass("before");this.self.removeClass("current");this.self.removeClass("after");e!=="current"&&this.self.removeClass("selected");this.self.addClass(e);this.state=e;return this.align()};e.prototype.moveTo=function(e){e-=this.self.width()/2;return this.self.css({left:e+"px"})};e.prototype.resize=function(){var e;e=this.p.getCanvas().height()-o.borderWidth*2;return this.self.height(e).width(e)};return e}();return this.each(function(){new n(this)})}})}).call(this);