// Generated by CoffeeScript 1.4.0
(function(){jQuery.fn.extend({coffeeflow:function(e){var t,n,r,i;r=jQuery;i=function(e){if(settings.debug)return typeof console!="undefined"&&console!==null?console.log(e):void 0};t=function(){function t(t){var s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E=this;m={blur:function(e){return i("CoffeeFlow blured")},change:function(e){return i("CoffeeFlow change")},ready:function(e){return i("CoffeeFlow ready")},select:function(e){return i("CoffeeFlow select")},focus:function(e){return i("CoffeeFlow focused")},borderWidth:2,debug:!1,density:3.2,defaultItem:2,minHeight:200,selectOnChange:!1};m=r.extend(m,e);d=this;y="";u=r(t);a=m.defaultItem;g=[];o=r('<div class="coffeeflowCanvas"></div>');h=u.find("a");this.getCanvas=function(){return o};this.getData=function(){return o.data()};this.getIndex=function(){return a};this.getItem=function(e){e==null&&(e=a);return g[e]};this.resize=function(){var e;u.height()>m.minHeight?e=u.height():e=m.minHeight;o.height(e);return s()};this.slideTo=function(e){a=e;s();m.change(d);if(m.selectOnChange)return g[e].select()};s=function(){var e,t,n,r,i,s,u;u=[];for(i=0,s=g.length;i<s;i++){t=g[i];t.resize();n=o.height()/m.density;if(i===a){y="current";e=g.length+1;r=o.width()/2}else if(i<a){y="before";e=i;r=o.width()/2-n/2-(a-i)*n}else{y="after";e=g.length-i;r=o.width()/2+n/2+(i-a)*n}t.setDepth(e);t.setState(y);u.push(t.moveTo(r))}return u};f=function(){return y};p=function(){o.addClass("ready");E.resize();return m.ready(d)};v=function(e){return e=e};for(b=0,w=h.length;b<w;b++){l=h[b];c=new n(l,b,d);g.push(c);c.appendTo(o)}u.append(o);this.resize();r(window).resize(function(e){return E.resize()});u.mouseover(function(e){if(!u.is(".coffeeflowFocuse")){u.addClass("coffeeflowFocuse");E.resize();m.focus(d)}return e.stopPropagation()});r("html").mouseover(function(e){if(u.is(".coffeeflowFocuse")){u.removeClass("coffeeflowFocuse");E.resize();m.blur(d);return e.stopPropagation()}});setTimeout(p,10)}return t}();n=function(){function e(e,t,n){var i,s,o,u,a,f=this;a="";n=n;u=r(e).addClass("coffeeflowItem");s=u.find("img");u.css({top:settings.borderWidth+"px"});s.css({"border-width":settings.borderWidth+"px",margin:-settings.borderWidth+"px"});s.load(function(e){return i()});u.click(function(e){e.preventDefault();return u.is(".current")?o():n.slideTo(t)});this.appendTo=function(e){return u.appendTo(e)};this.setDepth=function(e){return u.css("z-index",e)};this.setState=function(e){u.removeClass("before");u.removeClass("current");u.removeClass("after");e!=="current"&&u.removeClass("selected");u.addClass(e);a=e;return i()};this.moveTo=function(e){e-=u.width()/2;return u.css({left:e+"px"})};this.resize=function(){var e;e=n.getCanvas().height()-settings.borderWidth*2;return u.height(e).width(e)};i=function(){switch(a){case"current":return s.css({left:(u.height()-s.width())/2+"px"});case"before":return s.css({left:0});case"after":return s.css({right:0})}};o=function(){u.addClass("selected");return settings.select(n)}}return e}();return this.each(function(){return new t(this,e)})}})}).call(this);